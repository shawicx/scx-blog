---
import themeConfig from '@/config'
import { ui } from '@/i18n/ui'
import { getPageInfo } from '@/utils/page'

const { currentLang, getLocalizedPath, isPost } = getPageInfo(Astro.url.pathname)
const { title, subtitle, i18nTitle } = themeConfig.site

const currentUI = ui[currentLang as keyof typeof ui] ?? {}
const headerTitle = i18nTitle ? currentUI.title : title
const headerSubtitle = i18nTitle ? currentUI.subtitle : subtitle

const TitleTag = isPost ? 'h2' : 'h1'
const SubtitleTag = isPost ? 'div' : 'h2'
---

<header
  class:list={[
    'fixed top-0 left-0 right-0 z-50 bg-white dark:bg-dark',
    'px-[min(7.25vw,3.731rem)] lg:px-[max(5.75rem,calc(50vw-34.25rem))]',
    'border-b border-gray-200 dark:border-gray-700',
    'cjk:tracking-0.02em',
  ]}
>
  <div class="mx-auto max-w-205.848 lg:max-w-[min(calc(75vw-16rem),44rem)] py-4">
    <TitleTag
      class:list={[
        isPost
          ? `text-5.375 c-secondary lg:(text-9 c-primary)`
          : `w-75% text-8 c-primary lg:(w-full text-9)`,
        'font-bold font-title',
      ]}
    >
    <!-- Fix text cropping issues during view transition on iOS by adding a div tag -->
    <div
      class="box-content inline-block pr-1"
      transition:name={`site-title-${currentLang}`}
      data-disable-theme-transition
    >
      <a
        id="site-title-link"
        href={getLocalizedPath('/')}
      >
          {headerTitle}
      </a>
    </div>
  </TitleTag>

    {headerSubtitle && (
      <SubtitleTag
        class:list={[
          isPost
            ? `op-0 lg:op-100`
            : 'w-75% lg:w-full',
          'text-3.5 c-secondary font-navbar lg:text-4',
        ]}
        aria-hidden={isPost}
      >
        {headerSubtitle}
      </SubtitleTag>
    )}
    </TitleTag>
  </div>
</header>
